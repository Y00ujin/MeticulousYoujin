## 2.3 앱을 구성하는 핵심 객체들

<br>
<br>

### 2.3.1 iOS 유저 인터페이스의 표현 구조
##### iOS는 일반 데스크톱과 유저 인터페이스 표현 구조가 다릅니다. 하나의 스크린에 여러 개의 창을 띄울 수 있는 데스크톱과 달리 iOS는 항상 디바이스 스크린에 꽉 들어차는 하나의 화면만을 표시할 수 있으며, 다른 프로그램이 실행되면 기존의 화면은 내려가고 그 자리를 새로운 화면이 대신 채웁니다. 이런 일련의 과정을 구현하는데에 `윈도우`와 `뷰 객체`가 사용됩니다.

##### 윈도우는 iOS에서 디바이스의 스크린을 빈틈없이 채우기 위한 객체로, 항상 유저 인터페이스 표현 계층의 최상위에 위치합니다. 뷰의 일종이지만 직접 콘텐츠를 가지지는 않으며 콘텐츠를 가진 뷰를 내부에 배치하여 앱 화면에 출력하는 역할을 합니다. 화면이 전환되더라도 윈도우 객체는 전환되지 않으며 단지 내부에 배치된 뷰의 콘텐츠만 변경됩니다.

##### 뷰는 콘텐츠를 담아 이를 스크린상에 표시하고, 사용자의 입력에 반응합니다. 윈도우의 일부를 자신의 영역으로 정의하고, 여깅 필요한 콘텐츠를 채워 넣어 스크린에 나타내는 동시에, 윈도우로부터 전달된 사용자의 입력에 반응하여 그에 맞는 결과를 처리합니다.

##### iOS에서 실행되는 모든 애플리케이션은 최소한 하나 이상의 윈도우와 뷰를 가집니다. 대부분의 경우에서 모바일 디바이스의 디스플레이는 하나뿐이므로 애플리케이션이 생성하는 윈도우 역시 하나이지만, 외부 디스플레이가 연결될 경우 애플리케이션은 두 번째 디스플레이에 콘텐츠를 표현하기 위해 새로운 윈도우 객체를 생성합니다.

##### 윈도우와 뷰 사이는 뷰 컨트롤러를 통해 연결됩니다. 뷰 컨트롤러는 뷰의 계층을 관리하여 윈도우에 전달하고, 모바일 디바이스에서 감지된 터치 이벤트를 윈도우로부터 전달받아 처리하는 역할을 합니다. 윈도우가 뷰를 직접 참조하지 않고 뷰 컨트롤러가 그 사이를 중계하는 구조 덕분에 윈도우는 뷰 컨트롤러를 통해 제공되는 뷰를 읽어 들여 표현할 뿐, 뷰를 직접 관리하지 않아도 됩니다.

##### 윈도우 객체는 하나의 뷰 컨트롤러를 루트 뷰 컨트롤러로 지정하여 참조합니다. 루트 뷰 컨트롤러로 지정되면 스토리보드에서 화면 왼쪽에 화살표가 붙어 루트 뷰 컨트롤러임을 식별해 줍니다.

##### 루트 뷰 컨트롤러를 제외한 나머지 뷰 컨트롤러는 윈도우 객체의 직접적인 관리 대상이 아닙니다. 윈도우 객체는 항상 루트 뷰 컨트롤러만을 참조합니다.

##### 우리가 스토리보드를 통해 편집하는 대부분의 뷰 컨트롤러들은 각자가 하나씩의 화면을 담당하여 콘텐츠를 표현하고 뷰를 관리합니다. 이를 씬이라는 용어로 부릅니다. 씬을 담당하고 콘텐츠를 표시하는 뷰 컨트롤러를 콘텐츠 뷰 컨트롤러라고 합니다.

##### 일부 특별한 뷰 컨트롤러는 씬을 표현하는 역할 대신, 다른 뷰 컨트롤러의 연결 관계를 관리하기도 합니다. 이들은 내부에 콘텐츠를 배치하는 대신 다른 뷰 컨트롤러를 배치하고, 이들을 서로 유기적인 관계로 엮이도록 만들어 줍니다. 내비게이션 컨트롤러나 탭 바 컨트롤러, 페이지 컨트롤러 등이 대표적인 예 입니다. 이들을 콘텐츠 뷰 컨트롤러와 구분하여 컨테이너 뷰 컨트롤러라고 합니다. 

##### 뷰 컨트롤러 내부는 수많은 뷰들로 이루어지는데, 이들 뷰는 자기 자신의 스크린상에 표시하기도 하지만, 동시에 다른 뷰 객체를 포함하는 컨테이너의 역할도 수행합니다. 이를 뷰의 계층 구조라고 합니다. 뷰의 계층 구조 상에서 다른 뷰를 포함하는 뷰는 슈퍼 뷰가 되고, 슈퍼 뷰에 포함된 뷰는 서브 뷰가 됩니다. 하나의 슈퍼 뷰는 다른 슈퍼뷰의 서브 뷰가 될 수 있으며, 서브 뷰 역시 하위에 포함된 서브 뷰를 기준으로 슈퍼 뷰가 될 수 있습니다. 서브 뷰는 슈퍼 뷰를 기준으로 레이아웃을 구성하고, 슈퍼 뷰는 서브 뷰가 레이아웃을 구성할 수 있도록 내부적으로 원점을 포함하는 좌표 체계를 제공합니다. 뷰의 계층 구조상에서 뷰들은 서로 상대적인 레이아웃을 이룹니다.

##### 일반적으로 각각의 씬은 자신만의 뷰 계층 구조를 가지고 있으며, 뷰 계층 구조 최상위에는 하나의 뷰가 존재합니다. 이 뷰를 루트 뷰 또는 콘텐츠 뷰라고 합니다. 테이블 뷰 컨트롤러에서는 테이블 뷰가 루트 뷰입니다.

##### 일반 뷰 컨트롤러에서는 View 객체가 루트 뷰의 역할을 담당합니다. 일반적으로 뷰는 다양한 크기를 가질 수 있지만, 루트 뷰는 항상 화면 전체를 채울 수 있는 크기를 유지합니다.

##### 루트 뷰 내부에는 각자의 크기와 영역, 표현할 콘텐츠를 가진 여러 개의 서브 뷰가 추가되는데, 일부 뷰의 영역은 겹치기도 합니다. 루트 뷰는 이와 같은 서브 뷰드릉ㄹ 모아 하나의 전체 뷰를 구성하고, 뷰 컨트롤러를 통해 이를 윈도우에 전달합니다. 아래 그림은 윈도우 객체와 뷰 컨트롤러, 그리고 루트 뷰의 참조 관계를 보여줍니다.

<br>
<br>

### 2.3.2 뷰 컨트롤러
##### 뷰 컨트롤러는 앱의 근간을 이루는 객체로, 모든 앱은 최소한 하나 이상의 뷰 컨트롤러로 구성됩니다. 이들은 뷰를 관리하고 화면과 데이터 사이의 상호 작용까지 관리하기도 합니다. 윈도우 객체로부터 전달된 이벤트를 받아 내부적으로 구현된 비즈니스 로직을 실행하고 그 결과로 얻어진 데이터를 콘텐츠로 만들어 화면으로 표현합니다.

<br>

#### View Controller
##### iOS에서 가장 기본이 되는 컨트롤러로서 앱의 데이터와 표시될 외형을 연결해서 하나의 동적인 화면을 만들어내는 컨트롤러 입니다. 뷰 컨트롤러에 해당하는 UIKit 프레임워크의 클래스는 UIViewController입니다.

<br>

#### Navigation Controller
##### 앱의 화면 이동에 대한 관리와 그에 연관된 처리를 담당해주는 컨트롤러입니다. 이 컨트롤러는 내부적으로 다른 컨트롤러를 포함하면서 콘트롤러끼리의 화면 이동을 처리해줍니다. 뷰를 포함하고 있지 않으므로 하나의 화면을 담당하지는 못하고, 다른 컨트롤러와 결합하여 부분적으로 화면을 구성합니다. 네비게이션 컨트롤러를 정의하는 UIKit 프레임워크 클래스는 UINavigationController입니다.

<br>

#### TableView Controller
##### 내부에 리스트 형식의 TableView를 포함하고 있어 여러 항목이나 데이터를 화면에 나열하기 위한 목적으로 사용되는 컨트롤러입니다. ViewController와 마찬가지로 하나의 컨트롤러가 하나의 화면을 이루는 화면 단위 컨트롤러입니다. 테이블 뷰 컨트롤러에 해당하는 UIKit 프레임워크는 UITableViewController 클래스입니다.

<br>

#### Tab Bar Controller
##### 화면을 나타내는 여러 탱비 있고, 탭을 터치하면 화면이 전환되는 형태의 앱을 만들고자 할 때 사용되는 컨트롤러입니다. 탭마다 다른 뷰 컨트롤러를 연결하여 화면을 구성하며 앞의 내비게이션 컨트롤러와 마찬가지로 직접 화면 전체를 나타내는 것이 아닌, 복합적으로 화면을 구성하는 역할을 합니다. UIKit 프레임워크의 클래스는 UITabbarContorller입니다.

<br>

#### Split View Controller
##### 스플릿 뷰 컨트롤러는 앞서 프로젝트를 생성하는 과정 중 프로젝트 템플릿 선택 단계에서Master-Detail Application 템플릿을 선택하면ㅅ 생성되는 기본 컨트롤러입니다. 마스터 페이지와 디테일 페이지로 구성되는 스플릿 뷰 컨트롤러는 화면 크기에 따라 두 페이지를 하나의 화면에 조합하여 보여줄 것인지 아니면 두 개의 화면으로 나누어 보여줄 것인지 자동으로 처리해주는 특징이 있습니다. UIKit 프레임워크의 클래스는 UISplitViewController입니다.

<br>

#### 뷰의 관리
##### 뷰 컨트롤러의 역할 중 뷰의 계층을 관리하는 역할은 특히 중요합니다. 뷰 컨트롤러에는 루트 뷰 하나가 존재하는데, 다양한 뷰가 루트 뷰로 지정될 수 있습니다. 수퍼 뷰와 서브 뷰, 그리고 때로운 서브 뷰 아래의 서브 뷰는 아래와 같은 뷰 계층 구조를 이룹니다.

##### ViewController아래 루트 뷰, 그 아래로 나머지 객체들이 서브 뷰 형태를 이루면서 추가되어 있습니다. 항상 모든 객체를 루트 뷰 혹은 그 아래에 추가해야 합니다. 루트 뷰 없이 곧바로 뷰 컨트롤러에 객체를 추가할 수는 없습니다.


<br>
<br>

### 2.3.3 뷰 컨트롤러의 상태 변화와 생명 주기
##### 앞서 우리는 앱 전체의 상태 변화와 생명 주기에 대해 살펴봤습니다. 앱의 생명 주기는 Not Running, InActive, Active, Background, Suspended 의 상태가 있었습니다. 뷰 컨트롤러도 생명 주기와 상태 변화를 가집니다. 뷰 컨트롤러는 다음과 같이 네 가지 상태로 나눌 수 있습니다.

##### Appearing : 뷰 컨트롤러가 스크린에 등장하기 시작한 순간부터 등장을 완료하기 직전까지의 상태입니다. 퇴장 중인 다른 뷰 컨트롤러와 교차하기도 하며, 이때 최장 중인 다른 뷰 컨트롤러의 상태는 Disappearing가 됩니다.

##### Appeared : 뷰 컨트롤러가 스크린 전체에 완전히 등장한 상태를 나타냅니다.

##### Disappearing : 뷰 컨트롤러가 스크린에서 가려지기 시작해서 완전히 가려지기 직전까지의 상태, 또는 퇴장하기 시작해서 완전히 퇴장하기 직전까지의 상태입니다. 이 상태의 뷰 컨트롤러는 새로 등장학 뷰 컨트롤러와 교차하기도 하며, 이때 등장 중인 다른 뷰 컨트롤러의 상태는 Appearing입니다.

##### Disappeared : 뷰 컨트롤러가 스크린에서 완전히 가려졌거나 혹은 퇴장한 상태를 나타냅니다.
<br>

#### 메소드로 보는 ViewController의 상태
##### viewWillAppear : Appearing으로 바뀌는 동안 뷰 컨트롤러는 앱 객체에 의해 viewWillAppear 메소드가 호출됩니다.
##### viewDidAppear : 화면이 등장하기 시작한 단계를 넘어서 완전히 등장하고 나면 viewDidAppear 메소드가 호출됩니다.
##### viewWillDisappear : 화면이 퇴장하는 상태 변화가 발생하면 그 즉시 viewWillDisappear 메소드가 호출됩니다.
##### viewDidAppear : 화면이 완전히 퇴장하고 나면 viewDidAppear 메소드가 호출됩니다.